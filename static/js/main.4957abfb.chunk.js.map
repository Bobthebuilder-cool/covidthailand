{"version":3,"sources":["useWebcam.js","useModel.js","useBoxRenderer.js","index.js","styles.module.css"],"names":["useWebcam","videoRef","_useState","useState","_useState2","Object","slicedToArray","webcamLoaded","setWebcamLoaded","useEffect","navigator","mediaDevices","getUserMedia","audio","video","facingMode","then","stream","current","srcObject","onloadedmetadata","useModel","modelPath","model","setModel","objectDetector","load","cnt","points","renderPredictions","predictions","canvasRef","ctx","getContext","clearRect","canvas","width","height","font","textBaseline","forEach","prediction","timer","fillStyle","clearTimeout","class","score","document","getElementById","classList","add","reduceBar","console","log","speakWarn","el","contains","setTimeout","remove","factor","jsBar","innerHTML","style","window","confirm","synth","speechSynthesis","pitch","utter","SpeechSynthesisUtterance","lang","speak","addEventListener","detectFrame","_ref","asyncToGenerator","regenerator_default","a","mark","_callee","wrap","_context","prev","next","display","detect","sent","requestAnimationFrame","stop","_x","_x2","_x3","apply","this","arguments","useBoxRenderer","shouldRender","App","useRef","cameraLoaded","process","react_default","createElement","className","styles","pageTitle","descTxt","vidWrapper","autoPlay","playsInline","muted","ref","rootElement","ReactDOM","render","src_App","module","exports","fixed","vidContainer"],"mappings":"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","file":"static/js/main.4957abfb.chunk.js","sourcesContent":["import { useEffect, useState } from 'react'\n\nconst useWebcam = videoRef => {\n  const [webcamLoaded, setWebcamLoaded] = useState(false)\n  useEffect(() => {\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      navigator.mediaDevices\n        .getUserMedia({\n          audio: false,\n          video: {\n            facingMode: 'user'\n          }\n        })\n        .then(stream => {\n          // window.stream = stream\n          videoRef.current.srcObject = stream\n          videoRef.current.onloadedmetadata = () => {\n            setWebcamLoaded(true)\n          }\n        })\n    }\n  }, [videoRef])\n  return webcamLoaded\n}\n\nexport default useWebcam\n","import { useEffect, useState } from 'react'\n\nimport objectDetector from '@cloud-annotations/object-detection'\n\nconst useModel = modelPath => {\n  const [model, setModel] = useState()\n  useEffect(() => {\n    objectDetector.load(modelPath).then(model => {\n      setModel(model)\n    })\n  }, [modelPath])\n  return model\n}\n\nexport default useModel\n","import { useEffect } from 'react'\n\n//const SCORE_DIGITS = 4\nlet cnt = 0;\nlet points = 100;\n\n// const getLabelText = (prediction) => {\n//     const scoreText = prediction.score.toFixed(SCORE_DIGITS)\n//     return prediction.class + ', score: ' + scoreText\n// }\n\nconst renderPredictions = (predictions, canvasRef) => {\n  \n  const ctx = canvasRef.current.getContext('2d')\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n  // Font options.\n  const font = '16px sans-serif'\n  ctx.font = font\n  ctx.textBaseline = 'top'\n  // predictions.forEach(prediction => {\n  //   const x = prediction.bbox[0]\n  //   const y = prediction.bbox[1]\n  //   const width = prediction.bbox[2]\n  //   const height = prediction.bbox[3]\n  //   // Draw the bounding box.\n  //   ctx.strokeStyle = '#00FFFF'\n  //   ctx.lineWidth = 4\n  //   ctx.strokeRect(x, y, width, height)\n  //   // Draw the label background.\n  //   ctx.fillStyle = '#00FFFF'\n  //   const textWidth = ctx.measureText(getLabelText(prediction)).width\n  //   const textHeight = parseInt(font, 10) // base 10\n  //   ctx.fillRect(x, y, textWidth + 4, textHeight + 4)\n  // })\n\n  predictions.forEach(prediction => {\n    var timer;\n    //console.log(prediction)\n    //const x = prediction.bbox[0]\n    //const y = prediction.bbox[1]\n    // Draw the text last to ensure it's on top.\n    ctx.fillStyle = '#000000'\n    //ctx.fillText(getLabelText(prediction), x, y)\n    clearTimeout(timer);\n    \n    if(prediction.class===\"Touch-Face\" && prediction.score > 0.75){\n      cnt++;\n      points = points-5;\n      if(points === 0){\n        document.getElementById(\"js-reset\").classList.add(\"show\");\n      }\n      if(points>=0){\n        reduceBar(points);\n      }\n      \n      console.log(\"val \",cnt)\n      if(cnt < 2){\n        speakWarn();\n        \n      }\n      let el = document.getElementById(\"js-body\");\n      if(!el.classList.contains(\"error\")){\n        el.classList.add(\"error\");\n        timer = setTimeout(function(){\n          el.classList.remove(\"error\");\n          cnt = 0;\n        },1500)\n      }\n     \n    }\n  })\n}\nconst reduceBar = (factor) =>{\n  var jsBar = document.getElementById(\"js-bar\");\n  var jsPoint = document.getElementById(\"js-point\");\n  jsPoint.innerHTML = factor;\n   console.log(factor)\n    jsBar.style.width = factor+\"%\";\n    if(factor === 0){\n      setTimeout(()=>{\n      window.confirm(\"You touched your face! Press the reset button to play a new game.\");\n      },300)\n    }\n  \n}\nconst speakWarn = () =>{\n  const synth = window.speechSynthesis\n  synth.pitch = 8;\n  //synth.rate = 10;\n  \n  const utter = new SpeechSynthesisUtterance(\"Don't touch your face\")\n  //const voices = speechSynthesis.getVoices()\n  \n  utter.lang = 'en-EN';\n  utter.pitch = 1;\n\n  synth.speak(utter);\n}\ndocument.getElementById(\"js-reset\").addEventListener(\"click\",function(){\n  points = 100;\n  reduceBar(points);\n  document.getElementById(\"js-reset\").classList.remove(\"show\");\n})\nconst detectFrame = async (model, videoRef, canvasRef) => {\n  \n  setTimeout(()=>{\n    document.getElementById(\"js-loading\").classList.add(\"off\");\n  },3000); //for opacity (1 to 0)\n  setTimeout(()=>{\n    document.getElementById(\"js-loading\").style.display = \"none\";\n  },3500); //take out loading from the screen\n  const predictions = await model.detect(videoRef.current)\n  renderPredictions(predictions, canvasRef)\n  requestAnimationFrame(() => {\n    detectFrame(model, videoRef, canvasRef)\n  })\n}\n\nconst useBoxRenderer = (model, videoRef, canvasRef, shouldRender) => {\n  useEffect(() => {\n    if (model && shouldRender) {\n      detectFrame(model, videoRef, canvasRef)\n    }\n  }, [canvasRef, model, shouldRender, videoRef])\n}\n\nexport default useBoxRenderer","import React, { useRef } from 'react'\nimport ReactDOM from 'react-dom'\n\nimport useWebcam from './useWebcam'\nimport useModel from './useModel'\nimport useBoxRenderer from './useBoxRenderer'\n\n\nimport styles from './styles.module.css'\n\nconst MODEL_PATH = process.env.PUBLIC_URL + '/model_web'\n\nconst App = () => {\n  const videoRef = useRef()\n  const canvasRef = useRef()\n\n  const cameraLoaded = useWebcam(videoRef)\n  const model = useModel(MODEL_PATH)\n  useBoxRenderer(model, videoRef, canvasRef, cameraLoaded)\n  \n  return (\n    <div>\n      <h2 className={styles.pageTitle}>\n        Prototype Face-Touch\n      </h2>\n      <div className={styles.descTxt}>\n      Face-touch prototype: as you can get the Coronavirus 2019 from touching areas around your mouth, eyes, and nose, it is advised to try your best to not touch your face. This program alerts you if you touch your face, or if you are about to touch it. As this is still a prototype, a few false alarms might occur, though it will accurately alert you when you are actually about to or have touched your face. IF YOU WANT TO RUN IT IN THE BACKGROUND, YOU CAN OPEN A TAB AND THEN OPEN ANOTHER SEPARATED TAB WHERE THE FACE-TOUCH TAB WILL BE BEHIND THE TAB WHICH YOU CAN DO YOUR WORK ON. If you touch your face, the alert will possibly continually be called out. In that case, you can wait until the program recognizes a decreased threat and stops, reposition your computer, or you can reload this page. Note that this program might take a few seconds to initialize. \n      </div>\n      <div className={styles.vidWrapper}> \n      <video\n        autoPlay\n        playsInline\n        muted\n        ref={videoRef}\n        width=\"600\"\n        height=\"400\"\n      />\n      <canvas\n        ref={canvasRef}\n        width=\"600\"\n        height=\"400\"\n      />\n      </div>\n\n      {/* <button onClick={()=>speakTest()} > Click</button>  */}\n     \n    </div>\n  )\n}\n\nconst rootElement = document.getElementById('root')\nReactDOM.render(<App />, rootElement)\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"fixed\":\"styles_fixed__v-bnh\",\"pageTitle\":\"styles_pageTitle__3IVuI\",\"descTxt\":\"styles_descTxt__2JAX4\",\"vidContainer\":\"styles_vidContainer__34qtC\",\"vidWrapper\":\"styles_vidWrapper__19Fmh\"};"],"sourceRoot":""}